2009-03-25  Masato Taruishi  <yamato@redhat.com>

	* src/plugins/60srpmix-hyperestraier:
	* misc/m4/plugins.m4:
	* misc/specs/srpmix.spec.in:
	new plugin

2009-03-25  Masatake YAMATO  <yamato@redhat.com>

	* src/helpers/build-spec-rearrange (use_old_autoconf_p): New function.
	(spec_file_hack): Use use_old_autoconf_p.

	* src/srpmix-build (parse_arguments:--rearrange-spec-command): 
	New option.
	
	* tests/01srpmix-ix.sh: New test case.

	* src/srpmix-ix (default_target): Make regexp pattern
	more specific.

	* src/helpers/build-spec-rearrange (main): Use
	the passed command line, EXTRA_COMMAND as the filter.

	* Remove unnecessary white spaces.
	
	* src/srpmix-ix (REARRANGE_SPEC_COMMAND): New variable.
	(print_usage:--rearrange-spec-command): New option.
	(srpm_rearrange_spec): Pass `REARRANGE_SPEC_COMMAND' to
	build-spec-rearrange.

2009-03-20  Masatake YAMATO  <yamato@redhat.com>

	* src/helpers/build-spec-rearrange (use_old_autoreconf_p): New function.
	(spec_file_hack): Use use_old_autoreconf_p.

2009-03-19  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix-ix (guess_target): Use $line
	for input to sed.
	(srpmix_deply): Pass ${rootdir}/${SPECDIR}/${xspec_file}
	 to guess_target.

2009-03-19  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix-ix (guess_target): New function.

	* src/srpmix (print_usage): Added s390x.

	* src/srpmix-ix (print_usage, default_multi_targets)
	(verify_target): Added s390x.

	* src/srpmix-build (print_usage): Added s390x.	
	
	* src/srpmix-ix (srpm_rearrange_spec): Use 
	build-spec-rearrange.

2009-03-18  Masatake YAMATO  <yamato@redhat.com>

	* src/helpers/build-spec-rearrange: New helper program.

2009-03-18  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix (print_usage): Added ppc and s390.

	* src/srpmix-ix (print_usage, default_multi_targets)
	(verify_target): Added ppc and s390.

	* src/srpmix-build (print_usage): Added ppc and s390.

2009-03-18  Masato Taruishi <taruishi@redhat.com>

        * misc/specs/srpmix.spec.in (%configre):
	enable some plugins.
	(BuildRequires): Added cscope, ctags, and emacs-common.
	(plugin-doxygen::%files): Temporary make the list empty.
	
2009-03-18  Masatake YAMATO  <yamato@redhat.com>

	* src/helpers/build-opt-rules (main): Reverse
	the rules list.

	* src/helpers/99default.scm: Renamed from default.scm.
	Added comments.

	* src/srpmix (SRPMIXBUILD_OPTS): Sort the
	rules before reading.

	* misc/specs/srpmix.spec.in (99default.scm): 
	Mark %config(noreplace).
	
2009-03-18  Masato Taruishi <taruishi@redhat.com>

	* src/srpmix: fix broekn glob use such as 'srpmix --name=yum-*'
	* configure.ac:
	* misc/m4/plugins.m4:
	add --enable-plugin-* options.
	* misc/m4/progs.m4:
	separate program check codes from configure.ac
	* src/srpmix:
	create plugin data based on plugin package.

2009-03-17  Masato Taruishi <taruishi@redhat.com>

	* src/srpmix-wrap:
	* src/srpmix-build: add --build-requires option.

2009-03-17  Masatake YAMATO  <yamato@redhat.com>

	* src/helpers/build-opt-rules (main): Return 0
	even if no rule is matched.

2009-03-16  Masatake YAMATO  <yamato@redhat.com>

	Introduce helpers directory and srpmix own
	config directory. opt-rules uses them.
	
	* tests/Makefile.am (TESTS_ENVIRONMENT): Added
	SRPMIX_SYSCONF_DIR.

	* src/srpmix (opt_rules): Handle multi rules.

	* src/srpmix-wrap (wrap_srpm): Reimplement
	just-print.

	* src/srpmix-ix (srpm_build): Use /dev/null
	as output. See the comment about this modification.

	* src/libsrpmix.sh.in (SRPMIX_SYSCONF_DIR): Set
	/etc/srpmix as default value.
	(SRPMIX_BUILD_OPT_RULES_DIR): New constant.
	(SRPMIX_VAR_DIR): use @PACKAGE@.

	* src/helpers/default.scm: New file.

	* src/Makefile.am (dist_srpmixconf_DATA): Install
	srpmix.cf to /etc/srpmix.

	* src/helpers: 
	* configure.ac (AC_OUTPUT[src/helpers/Makefile]): 
	* misc/specs/srpmix.spec.in (%files/helpers): New directory.

2009-03-16  Masatake YAMATO  <yamato@redhat.com>

	* tests/Makefile.am (dist_check_SCRIPTS): Added 
	00build-opt-rules.
	(TESTS_ENVIRONMENT): Added SRPMIX_USR_DIR.

	* tests/00build-opt-rules: New test.

	* src/srpmix (opt_rules): Use build-opt-rules.
	
	* src/Makefile.am (helpersdir): New directory.
	(dist_helpers_SCRIPTS): New primary.

	* src/build-opt-rules: New helper script which
	was called opt-rules.

	* src/libsrpmix.sh.in (SRPMIX_HELPER_DIR, GOSH): 
	New constants.

2009-03-16  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix-wrap (main): Don't create TMPDIR
	if JUST_PRINT is specified.

2009-03-16  Masato Taruishi <taruishi@redhat.com>

	* sramix-wrap:
	* srpmix-envelop:
	* srpmix-build:
	plugin package support
	* src/:
	use #!/bin/bash instead of #!/bin/sh

2009-03-16  Masatake YAMATO <yamato@redhat.com>

	* src/srpmix-ix (spec_file_hack):  Added an extra
	rewrite rule to handle duplicate source46 in kernel.
	
2009-03-15  Masato Taruishi <taruishi@redhat.com>

	* configure.ac(with_test_srpms): fix absolute path handling

2009-03-14  Masato Taruishi <taruishi@redhat.com>

	* tests/: Rerutrn 77 for all tests.
	* src/libsrpmix.sh.in:
	* src/srpmix: support userland installation.
	non-root 'srpmix --name=yum' installs trees under $HOME/srpmix/
	* src/srpmix-build: separate build code from srpmix
	* src/plugins/60srpmix-cscope: handle all text files

2009-03-14  Masatake YAMATO  <yamato@redhat.com>

	* tests/00srpmix.sh: Return 77 if no TEST_SRPMS is given.

	* configure.ac (with_test_srpms): Convert relative paths 
	to absolute paths.
	
2009-03-13  Masatake YAMATO  <yamato@redhat.com>

	* src/plugins/60srpmix-kindex (main): Copy
	tags and TAGS if they exist.

	* src/srpmix-ix (srpm_deploy): Don't set
	target for kernel statically. Use opt-rules.
	(srpm_deploy): Use "," for seperator to separate
	targets.

2009-03-13  Masatake YAMATO  <yamato@redhat.com>

	* src/plugins/60srpmix-ctags (main): Don't run
	if tags target is defined in Makefile.
	* src/plugins/60srpmix-etags (main): Don't run
	if TAGS target is defined in Makefile.

	* src/srpmix-ix (srpm_deploy): Use only ia64 as
	the target when build source code of 2.4 kernle.

2009-03-13  Masato Taruishi <taruishi@redhat.com>

	* tests/: simple testing framework.
	* configure.ac: add --with-test-srpms.
	* src/plugins/60srpmix-cscope: handle only for pre-build.

2009-03-13  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix-ix (dont_keep_original): Withdraw
	"--without-ibcs" hack.

2009-03-13  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix-ix (spec_file_hack): Added an extra
	rewrite rule to handle duplicated source29 in kernel.
	(dont_keep_original): Call rpmbuild with "--without-ibcs"
	option to build kernel-2.4.18-e.12.
	(dont_keep_original): Added kernel-2.4.spec.

2009-03-13  Masato Taruishi <taruishi@redhat.com>

	* src/srpmix-ix: don't remove writable flag for owner.
	* src/srpmix-plugin: fix broken srpmix-plugin by list_plugins change
	* src/srpmix: put creation of swrf package to libsrpmix.sh.
	add --output-format option.

2009-03-13  Masatake YAMATO  <yamato@redhat.com>

	* misc/specs/srpmix.spec.in (plugin-vanilla::Requires): Added
	lzma.

	* src/plugins/10srpmix-vanilla (main): Remove ${d} 
	related code. Its value was not defiend.
	(run_vanilla): Added support for .lzma and tar.lzma.
	make relative symlinks.

	* src/srpmix-plugin (parse_arguments): Use --list
	instead of --list-plugins. Added more help documents.
	(list_plugins): Change the output format.

2009-03-12  Masato Taruishi <taruishi@redhat.com>

	* src/plugin/60srpmix-doxygen: Initial implementetation.

2009-03-12  Masatake YAMATO  <yamato@redhat.com>

	* src/plugins/50srpmix-coreutils: Fix a typo in comment.

2009-03-12  Masato Taruishi <taruishi@redhat.com>

	* src/plugins/: renumbering plugins
	* src/plugin/50srpmix-coreutils: Implemented

2009-03-11  Masatake YAMATO  <yamato@redhat.com>

	* src/srpmix (--target): New option.

	* src/srpmix-ix (SRPMIX_TARGET): New environment variable.

	* srpmix-ix (get_current_target): Use _target_cpu
	again. Don't use _host_cpu.

2009-03-11  Masatake YAMATO  <yamato@redhat.com>

	* src/plugins/11srpmix-kindex: Implemented.

	* src/plugins/10srpmix-ctags: New file.

	* src/srpmix-ix (srpm_deploy): Build only kernel.i686 and
	kernel.x86_64.

	* src/plugins/5srpmix-vanilla (TMPDIR): Use `basename' when
	making a temporary directory.

	* src/plugins/91srpmix-cscope (REGEX): Fix a typo in a log message.

2009-03-10  Masatake YAMATO  <yamato@redhat.com>

	* misc/specs/srpmix.spec.in (plugin-cscope): Added `Group'
	field. rpmbuild of centos5 requires this field.

	* src/srpmix-ix (MULTI_KERNEL): Experimental feature
	to build soruce code for multiple architectures.

	* src/libsrpmix.sh.in (SRPMIX_USR_DIR, SRPMIX_SWRFS_DIR)
	(SRPMIX_PLUGIN_DIR): Give values only if values are not
	given yet.

2009-03-09  Masatake YAMATO  <yamato@redhat.com>

	* configure.ac: version 3.104.0.

	* src/srpmix-ix (patch_on_backup_p): New function.
	(spec_file_hack): Use `patch_on_backup_p'.
	
	* configure.ac (AC_RPM_RELEASE): add --with-rpm-release=R
	option.

	* misc/m4/rpm.m4: New file.

2009-03-08  Masato Taruishi  <taruishi@redhat.com>

	* src/srpmix-plugin: add --enable|--disable option.
	add SRPMIX_EXTRA_PLUGINS configuration.
	run all the each source root directory by default.

	* src/srpmix-db: invoke srpmix-plugin for each development.

	* src/plugins/91srpmix-cscope: add cscope plugin.

2009-03-07  Masatake YAMATO  <yamato@redhat.com>

	* src/plugins: new directory.

	* src/srpmix (parse_arguments): Fix a typo
	SRPMIX_MULTIE_TARGETS => SRPMIX_MULTI_TARGETS.

2009-03-06  Masatake YAMATO  <yamato@redhat.com>

	* srpmix-ix (get_current_target): Use _host_cpu
	instead of _target_cpu.

2009-03-05  Masatake YAMATO  <yamato@redhat.com>

	* configure.ac: version 3.103.0.

	* src/srpmix: Avoid duplicated building when
	running rpmbuild after srpmix-envelop.

	* src/srpmix-ix (dont_keep_original): Handle -P in %patch 
	of spec file.

	* src/srpmix-weakview-dist (create_dist_weakview%build): 
	Include dist-mapping.es.

2009-03-04  Masatake YAMATO  <yamato@redhat.com>

	* configure.ac: version 3.102.6.
	* src/srpmix: Added --keep-original.
	* src/srpmix-ix: Added a new spec rewrite-rule
	patch -> patch0.

2009-02-22  Masatake YAMATO  <yamato@redhat.com>

	* configure.ac: version 3.102.2.

	* src/srpmix:
	* src/srpmix-in: New option --current-target-only.
	
	* src/srpmix-ix:
	* src/srpmix-wrap:
	* src/srpmix-envelop:
	* src/libsrpmix.in: Separate SRPMIX_VERSION and SRPMIX_PKG_VERSION.
	SRPMIX_VERSION is for this software itself. SRPMIX_PKG_VERSION
	is for the generated rpm packages.
	

	* src/srpmix (OUTPUT_DIR): Convert to absolute path.

	* src/srpmix-envelop(%preun, %post, %pre): fix a bug: all files were
	removed when updating with -U.

	* src/srpmix: Reflect --relase argument to SRPMIX_RELEASE variable.

	* srpmix-envelop, srpmix-ix: Added --ignore-error option.

2008-08-01  Masatake YAMATO  <yamato@redhat.com>

	* srpmix-plugin (PLUGINDIR): Added --list-plugins
	but not tested yet.

Summary: Scripts to install and expand src.rpm
Name: srpmix
Version: #PACKAGE_VERSION#
Release: #RPM_RELEASE#
Source: srpmix-#PACKAGE_VERSION#.tar.bz2
Requires: hardlink cpio rpm coreutils emacs-common guile file gauche
Buildarch: noarch

Buildroot: %{_tmppath}/%{name}-root
License: GPL

Group: Development/Tools

%description
Scripts to expand src.rpm.

%package plugin-vanilla
Summary: SRPMix Plugin for creating vanilla tree.
Requires: srpmix libgcj lzma

%description plugin-vanilla
SRPMix Plugin for creating vanilla tree.

%package plugin-cscope
Summary: SRPMix Plugin for creating cscope indexes.
Requires: srpmix cscope
Group: Development/Tools

%description plugin-cscope
SRPMix Plugin for creating cscope indexes.


%package plugin-kindex
Summary: SRPMix Plugin for running make tags and make TAGS of kernel
Requires: srpmix emacs-common ctags gcc
Group: Development/Tools

%description plugin-kindex
SRPMix Plugin for running make tags and make TAGS of kernel

%package plugin-ctags
Summary: SRPMix Plugin for creating ctags indexes.
Requires: srpmix ctags
Group: Development/Tools

%description plugin-ctags
SRPMix Plugin for creating ctags indexes.

%package plugin-doxygen
Summary: SRPMix Plugin for creating doxygen documents.
Requires: srpmix doxygen
Group: Development/Tools

%description plugin-doxygen
SRPMix Plugin for creating doxygen documents.

%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
%makeinstall

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%{_bindir}/srpmix
%{_bindir}/srpmix-build
%{_bindir}/srpmix-ix
%{_bindir}/libsrpmix.sh

%{_bindir}/srpmix-wrap

%{_bindir}/srpmix-db

%{_bindir}/srpmix-envelop

%{_bindir}/srpmix-weakview-dist
%{_bindir}/srpmix-weakview-packages
%{_bindir}/srpmix-plugin

%{_datadir}/srpmix/plugins/50srpmix-coreutils
%{_datadir}/srpmix/plugins/50srpmix-file
%{_datadir}/srpmix/plugins/60srpmix-etags

%{_datadir}/srpmix/utils

%{_datadir}/srpmix/helpers
%{_datadir}/srpmix/helpers/build-opt-rules

%{_sysconfdir}/srpmix
%{_sysconfdir}/srpmix/srpmix.cf
%config(noreplace) %{_sysconfdir}/srpmix/build-opt-rules.d/99default.scm

%{_sysconfdir}/cron.daily/srpmix.daily

%files plugin-cscope
%{_datadir}/srpmix/plugins/60srpmix-cscope

%files plugin-vanilla
%{_datadir}/srpmix/plugins/10srpmix-vanilla

%files plugin-kindex
%{_datadir}/srpmix/plugins/60srpmix-kindex

%files plugin-ctags
%{_datadir}/srpmix/plugins/60srpmix-ctags

%files plugin-doxygen
%{_datadir}/srpmix/plugins/60srpmix-doxygen

##
## TODO requires background execution to enable these post
##
#%post plugin-cscope
#if [ "$1" = 1 ] ; then
#  srpmix-plugin --enable=60srpmix-cscope
#fi

#%post plugin-vanilla
#if [ "$1" = 1 ] ; then
#  srpmix-plugin --enable=5srpmix-vanilla
#fi

#%post plugin-kindex
#if [ "$1" = 1 ] ; then
#  srpmix-plugin --enable=11srpmix-kindex
#fi

#%post plugin-ctags
#if [ "$1" = 1 ] ; then
#  srpmix-plugin --enable=10srpmix-ctags
#fi

%changelog
* Sat Jun  2 2007 Masatake YAMATO <yamato@redhat.com> 3.0-0
- First RPM build.

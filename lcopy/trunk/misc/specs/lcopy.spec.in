Summary: Scripts to update local copies gettting from vcs repositories 
Name: lcopy
Version: @PACKAGE_VERSION@
Release: 0
Source: lcopy-@PACKAGE_VERSION@.tar.bz2
#Requires: 
Prereq: /usr/sbin/useradd
Requires: emacs-common ctags cvs subversion git mercurial bzr
Buildarch: noarch

Buildroot: %{_tmppath}/%{name}-root
License: GPL

Group: Development/Tools

%description
Scripts to update local copies getting from vcs  repositories 


%prep
%setup -q

%build
%configure
make

%install
rm -rf $RPM_BUILD_ROOT
%makeinstall
mkdir -p $RPM_BUILD_ROOT%{_sysconfdir}/lcopy-refresh.d
mkdir -p $RPM_BUILD_ROOT%{_sysconfdir}/cron.daily

install -p -m 755 etc/lcopy-refresh.cron    $RPM_BUILD_ROOT%{_sysconfdir}/cron.daily/lcopy-refresh
install -p -m 644 etc/default.lcopy-refresh $RPM_BUILD_ROOT%{_sysconfdir}/lcopy-refresh.d/default.lcopy-refresh


mkdir -p $RPM_BUILD_ROOT/var/lib/lcopy
mkdir -p $RPM_BUILD_ROOT/var/lib/lcopy/sources
mkdir -p $RPM_BUILD_ROOT/var/lib/lcopy/log
mkdir -p $RPM_BUILD_ROOT/var/lib/lcopy/specs

%pre
/usr/sbin/useradd -c "Lcopy" lcopy 2>/dev/null || :

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
%{_bindir}/lcopy
%{_bindir}/lcopy-rebirth
%{_bindir}/lcopy-refresh
%{_bindir}/lcopy-genspec
%{_bindir}/liblcopy.sh
%{_libexecdir}/lcopy/plugins/10lcopy-ctags
%{_libexecdir}/lcopy/plugins/10lcopy-etags
%{_mandir}/man?/*

%attr(0755, root, root) %{_sysconfdir}/cron.daily/lcopy-refresh
%attr(0755, root, root) %dir %{_sysconfdir}/lcopy-refresh.d

%config(noreplace) %{_sysconfdir}/lcopy-refresh.d/default.lcopy-refresh

%attr(0755, lcopy, lcopy) %dir /var/lib/lcopy
%attr(0755, lcopy, lcopy) %dir /var/lib/lcopy/sources
%attr(0755, lcopy, lcopy) %dir /var/lib/lcopy/log
%attr(0755, lcopy, lcopy) %dir /var/lib/lcopy/specs


%changelog
* Thu Aug  7 2008 Masatake YAMATO <yamato@redhat.com> - 0.0.9-3
- Added files entry for 10lcopy-ctags.

* Thu Aug  7 2008 Masatake YAMATO <yamato@redhat.com> - 0.0.9-2
- Added files entry for 101copy-etags.

* Sat Jul  5 2008 Masatake YAMATO <yamato@redhat.com> - 0.0.2-1
- Added lcopy-sources package.

* Mon Aug 27 2007 Masatake YAMATO <yamato@redhat.com> - 0.0.2-0
- First RPM build.
